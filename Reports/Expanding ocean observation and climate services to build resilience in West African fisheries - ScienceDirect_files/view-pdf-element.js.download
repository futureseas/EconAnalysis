function e(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o}const t=new WeakMap,s=e=>"function"==typeof e&&t.has(e),i="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,n=(e,t,s=null)=>{for(;t!==s;){const s=t.nextSibling;e.removeChild(t),t=s}},r={},o={},a=`{{lit-${String(Math.random()).slice(2)}}}`,l=`\x3c!--${a}--\x3e`,d=new RegExp(`${a}|${l}`);class c{constructor(e,t){this.parts=[],this.element=t;const s=[],i=[],n=document.createTreeWalker(t.content,133,null,!1);let r=0,o=-1,l=0;const{strings:c,values:{length:p}}=e;for(;l<p;){const e=n.nextNode();if(null!==e){if(o++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:s}=t;let i=0;for(let e=0;e<s;e++)h(t[e].name,"$lit$")&&i++;for(;i-- >0;){const t=c[l],s=g.exec(t)[2],i=s.toLowerCase()+"$lit$",n=e.getAttribute(i);e.removeAttribute(i);const r=n.split(d);this.parts.push({type:"attribute",index:o,name:s,strings:r}),l+=r.length-1}}"TEMPLATE"===e.tagName&&(i.push(e),n.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(a)>=0){const i=e.parentNode,n=t.split(d),r=n.length-1;for(let t=0;t<r;t++){let s,r=n[t];if(""===r)s=u();else{const e=g.exec(r);null!==e&&h(e[2],"$lit$")&&(r=r.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),s=document.createTextNode(r)}i.insertBefore(s,e),this.parts.push({type:"node",index:++o})}""===n[r]?(i.insertBefore(u(),e),s.push(e)):e.data=n[r],l+=r}}else if(8===e.nodeType)if(e.data===a){const t=e.parentNode;null!==e.previousSibling&&o!==r||(o++,t.insertBefore(u(),e)),r=o,this.parts.push({type:"node",index:o}),null===e.nextSibling?e.data="":(s.push(e),o--),l++}else{let t=-1;for(;-1!==(t=e.data.indexOf(a,t+1));)this.parts.push({type:"node",index:-1}),l++}}else n.currentNode=i.pop()}for(const e of s)e.parentNode.removeChild(e)}}const h=(e,t)=>{const s=e.length-t.length;return s>=0&&e.slice(s)===t},p=e=>-1!==e.index,u=()=>document.createComment(""),g=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class m{constructor(e,t,s){this.__parts=[],this.template=e,this.processor=t,this.options=s}update(e){let t=0;for(const s of this.__parts)void 0!==s&&s.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=i?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],s=this.template.parts,n=document.createTreeWalker(e,133,null,!1);let r,o=0,a=0,l=n.nextNode();for(;o<s.length;)if(r=s[o],p(r)){for(;a<r.index;)a++,"TEMPLATE"===l.nodeName&&(t.push(l),n.currentNode=l.content),null===(l=n.nextNode())&&(n.currentNode=t.pop(),l=n.nextNode());if("node"===r.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(l.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,r.name,r.strings,this.options));o++}else this.__parts.push(void 0),o++;return i&&(document.adoptNode(e),customElements.upgrade(e)),e}}const f=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),y=` ${a} `;class v{constructor(e,t,s,i){this.strings=e,this.values=t,this.type=s,this.processor=i}getHTML(){const e=this.strings.length-1;let t="",s=!1;for(let i=0;i<e;i++){const e=this.strings[i],n=e.lastIndexOf("\x3c!--");s=(n>-1||s)&&-1===e.indexOf("--\x3e",n+1);const r=g.exec(e);t+=null===r?e+(s?y:l):e.substr(0,r.index)+r[1]+r[2]+"$lit$"+r[3]+a}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==f&&(t=f.createHTML(t)),e.innerHTML=t,e}}const _=e=>null===e||!("object"==typeof e||"function"==typeof e),w=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class b{constructor(e,t,s){this.dirty=!0,this.element=e,this.name=t,this.strings=s,this.parts=[];for(let e=0;e<s.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new S(this)}_getValue(){const e=this.strings,t=e.length-1,s=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=s[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!w(e))return e}let i="";for(let n=0;n<t;n++){i+=e[n];const t=s[n];if(void 0!==t){const e=t.value;if(_(e)||!w(e))i+="string"==typeof e?e:String(e);else for(const t of e)i+="string"==typeof t?t:String(t)}}return i+=e[t],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class S{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===r||_(e)&&e===this.value||(this.value=e,s(e)||(this.committer.dirty=!0))}commit(){for(;s(this.value);){const e=this.value;this.value=r,e(this)}this.value!==r&&this.committer.commit()}}class P{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(u()),this.endNode=e.appendChild(u())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=u()),e.__insert(this.endNode=u())}insertAfterPart(e){e.__insert(this.startNode=u()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;s(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=r,e(this)}const e=this.__pendingValue;e!==r&&(_(e)?e!==this.value&&this.__commitText(e):e instanceof v?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):w(e)?this.__commitIterable(e):e===o?(this.value=o,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,s="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=s:this.__commitNode(document.createTextNode(s)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof m&&this.value.template===t)this.value.update(e.values);else{const s=new m(t,e.processor,this.options),i=s._clone();s.update(e.values),this.__commitNode(i),this.value=s}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let s,i=0;for(const n of e)s=t[i],void 0===s&&(s=new P(this.options),t.push(s),0===i?s.appendIntoPart(this):s.insertAfterPart(t[i-1])),s.setValue(n),s.commit(),i++;i<t.length&&(t.length=i,this.clear(s&&s.endNode))}clear(e=this.startNode){n(this.startNode.parentNode,e.nextSibling,this.endNode)}}class x{constructor(e,t,s){if(this.value=void 0,this.__pendingValue=void 0,2!==s.length||""!==s[0]||""!==s[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=s}setValue(e){this.__pendingValue=e}commit(){for(;s(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=r,e(this)}if(this.__pendingValue===r)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=r}}class k extends b{constructor(e,t,s){super(e,t,s),this.single=2===s.length&&""===s[0]&&""===s[1]}_createPart(){return new T(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class T extends S{}let C=!1;(()=>{try{const e={get capture(){return C=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class E{constructor(e,t,s){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=s,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;s(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=r,e(this)}if(this.__pendingValue===r)return;const e=this.__pendingValue,t=this.value,i=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),n=null!=e&&(null==t||i);i&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),n&&(this.__options=M(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=r}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const M=e=>e&&(C?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);const N=new class{handleAttributeExpressions(e,t,s,i){const n=t[0];if("."===n){return new k(e,t.slice(1),s).parts}if("@"===n)return[new E(e,t.slice(1),i.eventContext)];if("?"===n)return[new x(e,t.slice(1),s)];return new b(e,t,s).parts}handleTextExpression(e){return new P(e)}};function A(e){let t=V.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},V.set(e.type,t));let s=t.stringsArray.get(e.strings);if(void 0!==s)return s;const i=e.strings.join(a);return s=t.keyString.get(i),void 0===s&&(s=new c(e,e.getTemplateElement()),t.keyString.set(i,s)),t.stringsArray.set(e.strings,s),s}const V=new Map,O=new WeakMap;"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const R=(e,...t)=>new v(e,t,"html",N);window.JSCompiler_renameProperty=(e,t)=>e;const z={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},U=(e,t)=>t!==e&&(t==t||e==e),H={attribute:!0,type:String,converter:z,reflect:!1,hasChanged:U};class I extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,s)=>{const i=this._attributeNameForProperty(s,t);void 0!==i&&(this._attributeToPropertyMap.set(i,s),e.push(i))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=H){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const s="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,s,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}static getPropertyDescriptor(e,t,s){return{get(){return this[t]},set(i){const n=this[e];this[t]=i,this.requestUpdateInternal(e,n,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||H}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const s of t)this.createProperty(s,e[s])}}static _attributeNameForProperty(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,s=U){return s(e,t)}static _propertyValueFromAttribute(e,t){const s=t.type,i=t.converter||z,n="function"==typeof i?i:i.fromAttribute;return n?n(e,s):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const s=t.type,i=t.converter;return(i&&i.toAttribute||z.toAttribute)(e,s)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,s){t!==s&&this._attributeToProperty(e,s)}_propertyToAttribute(e,t,s=H){const i=this.constructor,n=i._attributeNameForProperty(e,s);if(void 0!==n){const e=i._propertyValueToAttribute(t,s);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(n):this.setAttribute(n,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const s=this.constructor,i=s._attributeToPropertyMap.get(e);if(void 0!==i){const e=s.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=s._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,s){let i=!0;if(void 0!==e){const n=this.constructor;s=s||n.getPropertyOptions(e),n._valueHasChanged(this[e],t,s.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==s.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,s))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}I.finalized=!0;const L=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(s){s.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(s){s.createProperty(t.key,e)}};function q(e){return(t,s)=>void 0!==s?((e,t,s)=>{t.constructor.createProperty(s,e)})(e,t,s):L(e,t)}const j=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,W=Symbol();class ${constructor(e,t){if(t!==W)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(j?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const F={};class J extends I{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,s)=>e.reduceRight((e,s)=>Array.isArray(s)?t(s,e):(e.add(s),e),s),s=t(e,new Set),i=[];s.forEach(e=>i.unshift(e)),this._styles=i}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map(e=>{if(e instanceof CSSStyleSheet&&!j){const t=Array.prototype.slice.call(e.cssRules).reduce((e,t)=>e+t.cssText,"");return new $(String(t),W)}return e})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?j?this.renderRoot.adoptedStyleSheets=e.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==F&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return F}}function B(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{}}function D(){const e=B().location||document.location;return e instanceof Location&&/^http/.test(e.origin)?{origin:e.origin,pathname:e.pathname,href:e.href}:{}}J.finalized=!0,J.render=(e,t,s)=>{let i=O.get(t);void 0===i&&(n(t,t.firstChild),O.set(t,i=new P(Object.assign({templateFactory:A},s))),i.appendInto(t)),i.setValue(e),i.commit()},J.shadowRootOptions={mode:"open"};const G=e=>{const{debug:t=!1}=B().viewPdfElement||{};if(!t){const t=new URL(e).searchParams.get("debug");return Boolean(t)}return t},{href:Z}=D();var Q=(...e)=>{G(Z)&&console.info(...e)},Y=(...e)=>{G(Z)&&console.warn(...e)},K=(...e)=>{G(Z)&&console.error(...e)};const X=()=>{const{rendering:e="viewport"}=B().viewPdfElement||{},t=e.trim();return!1===/^(auto|viewport)$/.test(t)?(Y(t+" is not supported value for rendering option"),"viewport"):t},ee=(e,t=300)=>{let s;return function(){clearTimeout(s),s=setTimeout(()=>e.apply(this),t)}},te=e=>{const{innerHeight:t=0}=B();return e.getBoundingClientRect().top<t},se={pending:{icon:R``,label:"",show:!1,iconSize:"large"},loading:{icon:R`<svg focusable="false" viewBox="0 0 114 128" class="icon" part="icon"><path d="M99.43 28.64l-7.07-7.07-18.39 18.39 7.07 7.07 18.39-18.39M14.57 99.36l7.07 7.07 18.39-18.39-7.07-7.07-18.39 18.39m59.4-11.32l18.39 18.39 7.07-7.07-18.39-18.39-7.07 7.07m-59.4-59.4l18.39 18.39 7.07-7.07-18.39-18.39-7.07 7.07M86 59h26v10H86V59zM2 59h26v10H2V59zm50 34h10v26H52V93zm0-84h10v26H52V9zm29.04 38.03l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39m-59.4 59.4l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39m59.4-59.4l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39m-59.4 59.4l-7.07-7.07 18.39-18.39 7.07 7.07-18.39 18.39M86 59h26v10H86V59zM2 59h26v10H2V59zm84 0h26v10H86V59zM2 59h26v10H2V59zm90.36 47.43L73.97 88.04l7.07-7.07 18.39 18.39-7.07 7.07m-59.4-59.4L14.57 28.64l7.07-7.07 18.39 18.39-7.07 7.07m59.4 59.4L73.97 88.04l7.07-7.07 18.39 18.39-7.07 7.07m-59.4-59.4L14.57 28.64l7.07-7.07 18.39 18.39-7.07 7.07M52 93h10v26H52V93zm0-84h10v26H52V9zm0 84h10v26H52V93zm0-84h10v26H52V9z"></path></svg>`,label:"Finding PDF...",show:!0,iconSize:"large"},found:{icon:R`<svg focusable="false" viewBox="0 0 32 32" class="icon" part="icon"><path d="M7 .362h17.875l6.763 6.1V31.64H6.948V16z" stroke="#000" stroke-width=".703" fill="#fff"></path><path d="M.167 2.592H22.39V9.72H.166z" stroke="#aaa" stroke-width=".315" fill="#da0000"></path><path fill="#fff9f9" d="M5.97 3.638h1.62c1.053 0 1.483.677 1.488 1.564.008.96-.6 1.564-1.492 1.564h-.644v1.66h-.977V3.64m.977.897v1.34h.542c.27 0 .596-.068.596-.673-.002-.6-.32-.667-.596-.667h-.542m3.8.036v2.92h.35c.933 0 1.223-.448 1.228-1.462.008-1.06-.316-1.45-1.23-1.45h-.347m-.977-.94h1.03c1.68 0 2.523.586 2.534 2.39.01 1.688-.607 2.4-2.534 2.4h-1.03V3.64m4.305 0h2.63v.934h-1.657v.894H16.6V6.4h-1.56v2.026h-.97V3.638"></path><path d="M19.462 13.46c.348 4.274-6.59 16.72-8.508 15.792-1.82-.85 1.53-3.317 2.92-4.366-2.864.894-5.394 3.252-3.837 3.93 2.113.895 7.048-9.25 9.41-15.394zM14.32 24.874c4.767-1.526 14.735-2.974 15.152-1.407.824-3.157-13.72-.37-15.153 1.407zm5.28-5.043c2.31 3.237 9.816 7.498 9.788 3.82-.306 2.046-6.66-1.097-8.925-4.164-4.087-5.534-2.39-8.772-1.682-8.732.917.047 1.074 1.307.67 2.442-.173-1.406-.58-2.44-1.224-2.415-1.835.067-1.905 4.46 1.37 9.065z" fill="#f91d0a"></path></svg>`,label:"View PDF",show:!0,iconSize:"large"},"found-doi":{icon:R`<svg focusable="false" viewBox="1 1 14 14" class="icon" part="icon"><g stroke="none" fill="none"><polyline points="6.8 2 2 2 2 14 14 14 14 9.2" stroke="currentColor" strokeWidth="1"/><polyline points="9 2 14 2 14 7" stroke="currentColor" strokeWidth="1"/><path d="M13.5,2.5 L8.5,7.5" stroke="currentColor" strokeWidth="1"/></g></svg>`,label:"View at publisher",show:!1,iconSize:"large"},failed:{icon:R`<svg viewBox="0 0 100 128" focusable="false" class="icon" part="icon"><path d="M50 14c-18.99-.28-37.3 11.76-44.82 29.14-7.95 17.45-4.3 39.36 8.96 53.22 12.48 13.75 33.08 19.14 50.71 13.36 18.88-5.76 33.13-23.92 34.06-43.67 1.41-18.84-9.32-37.78-26.1-46.41C65.82 15.93 57.92 13.99 50 14zm0 9.6c17.84-.32 34.64 13.09 38.39 30.52 4.11 16.54-4.05 35.03-19 43.19-15.16 8.88-36 5.78-47.9-7.15-12.36-12.5-14.46-33.5-4.82-48.2C23.71 30.68 36.68 23.46 50 23.6zM45 38v10h10V38H45zm0 16v34h10V54H45z"/></svg>`,label:"PDF not found",show:!1,iconSize:"large"}};function ie(e){const t=[""+e];return t.raw=[""+e],R(t)}const ne=Object.keys(se),re=(()=>{const{states:e=[]}=B().viewPdfElement||{};return e})().filter(e=>-1!==ne.indexOf(e.name)).reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:{icon:t.icon?ie(t.icon):se[t.name].icon,label:t.label||se[t.name].label,show:"boolean"==typeof t.show?t.show:se[t.name].show,iconSize:t.iconSize||"large"}}),{}),oe=Object.assign(Object.assign({},se),re),ae=((e,...t)=>{const s=t.reduce((t,s,i)=>t+(e=>{if(e instanceof $)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(s)+e[i+1],e[0]);return new $(s,W)})`@keyframes es-spin{0%{transform:rotateZ(0)}100%{transform:rotateZ(360deg)}}:host{display:inline-block}.es-link{color:var(--es-color-theme,#007398);cursor:pointer;display:inline-block;font-family:inherit;font-size:inherit;text-decoration:none;transition:color var(--es-animation-hover,.3s) ease,border-bottom-color var(--es-animation-hover,.3s) ease}.es-link:active,.es-link:focus,.es-link:hover{color:var(--es-color-theme-2,#e9711c)}.es-link:active .text,.es-link:focus .text,.es-link:hover .text{border-bottom:2px solid var(--es-color-theme-2,#e9711c)}.es-link.disabled,.es-link.disabled:active,.es-link.disabled:focus,.es-link.disabled:hover{color:var(--es-color-disabled,#b9b9b9);cursor:not-allowed}.es-link.disabled .text,.es-link.disabled:active .text,.es-link.disabled:focus .text,.es-link.disabled:hover .text{border-bottom:0;transition:all 0s ease 0s}.es-link.loading .icon{animation:3s linear infinite es-spin}.es-link .icon,.es-link .text{display:inline-block;vertical-align:middle}.es-link .icon{fill:currentColor;overflow:hidden}.es-link.icon-large .icon{height:1.5em;width:1.5em;margin-right:.5em}.es-link.icon-small .icon{height:1em;width:1em;margin-right:.3em}.es-link .text{border-bottom:2px solid transparent;transition:border-bottom-color var(--es-animation-hover,.3s)}`;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var le=function(e,t,s){return e(s={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&s.path)}},s.exports),s.exports}((function(e,t){var s;s=function(){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}return s.m=e,s.c=t,s.p="",s(0)}([function(e,t){var s=function(){function e(t){var s=this;void 0===t&&(t={processTrackingProperties:{addTrackingProperties:e.defaultAddTrackingProperties,getTrackingProperties:e.defaultGetTrackingProperties},isErrorMessage:e.defaultIsErrorMessage,receiveWindow:window,name:e.createRandomString()}),this.pendingRequestPromises={},this.addTrackingProperties=t.processTrackingProperties&&t.processTrackingProperties.addTrackingProperties||e.defaultAddTrackingProperties,this.getTrackingProperties=t.processTrackingProperties&&t.processTrackingProperties.getTrackingProperties||e.defaultGetTrackingProperties,this.isErrorMessage=t.isErrorMessage||e.defaultIsErrorMessage,this.receiveWindow=t.receiveWindow||window,this.name=t.name||e.createRandomString(),this.logMessages=t.logMessages||!1,this.eventSourceOverrideWindow=t.eventSourceOverrideWindow,this.suppressWarnings=t.suppressWarnings||!1,this.logMessages&&console.log("new WindowPostMessageProxy created with name: "+this.name+" receiving on window: "+this.receiveWindow.document.title),this.handlers=[],this.windowMessageHandler=function(e){return s.onMessageReceived(e)},this.start()}return e.defaultAddTrackingProperties=function(t,s){return t[e.messagePropertyName]=s,t},e.defaultGetTrackingProperties=function(t){return t[e.messagePropertyName]},e.defaultIsErrorMessage=function(e){return!!e.error},e.createDeferred=function(){var e={resolve:null,reject:null,promise:null},t=new Promise((function(t,s){e.resolve=t,e.reject=s}));return e.promise=t,e},e.createRandomString=function(){var e=window.crypto||window.msCrypto,t=new Uint32Array(1);return e.getRandomValues(t),t[0].toString(36).substring(1)},e.prototype.addHandler=function(e){this.handlers.push(e)},e.prototype.removeHandler=function(e){var t=this.handlers.indexOf(e);if(-1===t)throw new Error("You attempted to remove a handler but no matching handler was found.");this.handlers.splice(t,1)},e.prototype.start=function(){this.receiveWindow.addEventListener("message",this.windowMessageHandler)},e.prototype.stop=function(){this.receiveWindow.removeEventListener("message",this.windowMessageHandler)},e.prototype.postMessage=function(t,s){var i={id:e.createRandomString()};this.addTrackingProperties(s,i),this.logMessages&&(console.log(this.name+" Posting message:"),console.log(JSON.stringify(s,null,"  "))),t.postMessage(s,"*");var n=e.createDeferred();return this.pendingRequestPromises[i.id]=n,n.promise},e.prototype.sendResponse=function(e,t,s){this.addTrackingProperties(t,s),this.logMessages&&(console.log(this.name+" Sending response:"),console.log(JSON.stringify(t,null,"  "))),e.postMessage(t,"*")},e.prototype.onMessageReceived=function(e){var t=this;this.logMessages&&(console.log(this.name+" Received message:"),console.log("type: "+e.type),console.log(JSON.stringify(e.data,null,"  ")));var s=this.eventSourceOverrideWindow||e.source,i=e.data;if("object"==typeof i){var n,r;try{n=this.getTrackingProperties(i)}catch(e){this.suppressWarnings||console.warn("Proxy("+this.name+"): Error occurred when attempting to get tracking properties from incoming message:",JSON.stringify(i,null,"  "),"Error: ",e)}if(n&&(r=this.pendingRequestPromises[n.id]),r){var o=!0;try{o=this.isErrorMessage(i)}catch(e){console.warn("Proxy("+this.name+") Error occurred when trying to determine if message is consider an error response. Message: ",JSON.stringify(i,null,""),"Error: ",e)}o?r.reject(i):r.resolve(i),delete this.pendingRequestPromises[n.id]}else this.handlers.some((function(e){var r=!1;try{r=e.test(i)}catch(e){t.suppressWarnings||console.warn("Proxy("+t.name+"): Error occurred when handler was testing incoming message:",JSON.stringify(i,null,"  "),"Error: ",e)}if(r){var o=void 0;try{o=Promise.resolve(e.handle(i))}catch(e){t.suppressWarnings||console.warn("Proxy("+t.name+"): Error occurred when handler was processing incoming message:",JSON.stringify(i,null,"  "),"Error: ",e),o=Promise.resolve()}return o.then((function(e){if(!e){var r="Handler for message: "+JSON.stringify(i,null,"  ")+" did not return a response message. The default response message will be returned instead.";t.suppressWarnings||console.warn("Proxy("+t.name+"): "+r),e={warning:r}}t.sendResponse(s,e,n)})),!0}}))||this.suppressWarnings||console.warn("Proxy("+this.name+") did not handle message. Handlers: "+this.handlers.length+"  Message: "+JSON.stringify(i,null,"")+".")}else this.suppressWarnings||console.warn("Proxy("+this.name+"): Received message that was not an object. Discarding message")},e.messagePropertyName="windowPostMessageProxy",e}();t.WindowPostMessageProxy=s}])},e.exports=s()}));class de{constructor(e,t){this.identifier=e,this.args=t,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}const ce=(()=>{const e=("__els_pdf_bridge___"+(()=>{const e=window.location,t=e.host;return`${e.protocol}//${t}`})()).replace(/[^a-zA-Z0-9]+/g,"_"),t=document.createElement("iframe");return t.setAttribute("name",e),t.setAttribute("id",e),t.setAttribute("style","display: none; margin: 0; padding: 0; border: 0px none; overflow: hidden;"),t.setAttribute("frameborder","0"),t.setAttribute("border","0"),t.setAttribute("scrolling","no"),t.setAttribute("allowTransparency","true"),t.setAttribute("tabindex","-1"),t.setAttribute("hidden","true"),t.setAttribute("title",""),t.setAttribute("role","presentation"),t.src="https://brxt-research.mendeley.com/",t})();document.body.appendChild(ce);const he="auto"===X()?50:150,pe=new class{constructor(e,t){this.messageProxy=new le.WindowPostMessageProxy,this.deferrals=[],this.maxConcurrency=10,this.iframe=e,this.waitFor=t,this.iframeLoaded=new Promise(t=>{e.addEventListener("load",()=>{Q("els-view-pdf:iframe.load()"),t()})})}enqueue(e,...t){let s=this.deferrals.find(t=>t.identifier===e);return Q("els-view-pdf:enqueue()",{identifier:e,args:t}),void 0===s&&(s=new de(e,t),this.deferrals.push(s),clearTimeout(this.timer),this.deferrals.length<this.maxConcurrency?this.timer=setTimeout(()=>{Q("els-view-pdf:dequeue()",{length:this.deferrals.length,timeout:!0}),this.dequeue()},this.waitFor):(Q("els-view-pdf:dequeue()",{length:this.deferrals.length,timeout:!1}),this.dequeue())),s.promise}dequeue(){const e=this.deferrals.length<this.maxConcurrency?this.deferrals.length:this.maxConcurrency,t=this.deferrals.splice(0,e);this.deferrals.length&&(this.timer=setTimeout(()=>{Q("els-view-pdf:dequeue()",{length:this.deferrals.length,timeout:!0}),this.dequeue()},this.waitFor)),this.process(t,D(),(()=>{const{integratorId:e}=B().viewPdfElement||{};return"number"==typeof e?e:"string"==typeof e&&/^\d.*$/.test(e)?parseInt(e,10):(Y("CPA Integrator ID has not been set properly."),0)})())}process(e,t,s){const{origin:i,pathname:n}=t,r={data:e.map(e=>e.args[0]),origin:i&&`${i}${n}`,integratorId:s,version:"0.5.1"};this.iframeLoaded.then(()=>{if(Q("els-view-pdf:postMessage()",r),!r.origin){const e=r.data.map(e=>({data:{doc_id:e.doc_id,entitled:!1}}));return Promise.resolve(e)}return this.messageProxy.postMessage(this.iframe.contentWindow,r)}).then(t=>{t.forEach(t=>{const s=e.find(e=>e.identifier===t.data.doc_id.toLowerCase());void 0!==s?(Q("els-view-pdf:deferral-resolved",{value:t}),s.resolve(t)):K("els-view-pdf:no-relevant-deferral-found",{value:t})})}).catch(t=>{K("els-view-pdf:post-message-error",t.message),e.forEach(e=>{K("els-view-pdf:deferral-rejected",t.message),e.reject(t.message)})})}}(ce,he);"viewport"===X()&&window.addEventListener("scroll",ee(()=>{const e=document.querySelectorAll("els-view-pdf-element.pending");for(const t of e){if(!te(t))break;t.setAttribute("state","loading")}},150));let ue=class extends J{constructor(){super(),this._state="auto"===X()?"loading":"pending",this.disabled=!0}connectedCallback(){super.connectedCallback(),"viewport"===X()?(this.setAttribute("class","pending"),pe.iframeLoaded.then(()=>{this.triggerEntitlementCheckQueue()})):this.handleLoaded()}createRenderRoot(){return this.attachShadow({mode:"open",delegatesFocus:!0})}handleLoaded(){Q("els-view-pdf:handleLoaded(): ",{doc_type:this.docType,doc_id:this.docId}),this.docId&&this.docType&&this.sendMessage(!1)}sendMessage(e){const t={doc_type:this.docType,doc_id:this.docId};this.entityId&&(t.entity_id=this.entityId),pe.enqueue(t.doc_id.toLowerCase(),t).then(t=>this.handleResponseMessage(t,e)).catch(()=>{this.handleResponseMessage({data:{entitled:!1}},!1)})}handleResponseMessage(e,t){e.data.entitled&&e.data.vor?(this.state="found",t&&window.open(e.data.vor,"_blank")):"doi"===this.docType?this.state="found-doi":this.state="failed"}handleClick(e){switch(e.preventDefault(),this.state){case"found-doi":window.open("https://www.doi.org/"+this.docId,"_blank");break;case"found":this.sendMessage(!0)}this.dispatchEvent(new CustomEvent("els-view-pdf-click",{bubbles:!0,detail:{doc_type:this.docType,doc_id:this.docId,entity_id:this.entityId,state:this.state}}))}triggerEntitlementCheckQueue(){te(this)&&"pending"===this.state&&(this.state="loading")}get label(){return oe[this.state].label}get icon(){return oe[this.state].icon}get entityId(){return(()=>{const{entityId:e=""}=B().viewPdfElement||{},t=e.trim();return t&&!1===/^http/.test(t)?(console.warn(t+" doesn't look like an valid entityId"),""):t})()}get state(){return this._state}set state(e){const t=-1!==["failed","loading"].indexOf(e);this.disabled=t,"pending"===this._state&&"loading"===e&&this.handleLoaded(),"found"!==this._state&&"found"===e&&this.dispatchEvent(new CustomEvent("els-view-pdf-found",{detail:{doc_type:this.docType,doc_id:this.docId}})),this._state=e,this.setAttribute("class",e),this.requestUpdate()}render(){const{state:e,icon:t,label:s,disabled:i,iconSize:n=""}=this,r=n||oe[e].iconSize;return"pending"===e?null:oe[e].show?R`<a href="javascript:;" target="_blank" class="es-link ${e} ${i?"disabled":""} icon-${r}" @click="${this.handleClick}" part="container">${t} <span class="text" part="label">${s}</span></a>`:null}};var ge;ue.styles=ae,e([q({type:Boolean,reflect:!0})],ue.prototype,"disabled",void 0),e([q({type:String})],ue.prototype,"state",null),e([q({type:String,attribute:"doc-type"})],ue.prototype,"docType",void 0),e([q({type:String,attribute:"doc-id"})],ue.prototype,"docId",void 0),e([q({type:String,attribute:"icon-size"})],ue.prototype,"iconSize",void 0),ue=e([(ge="els-view-pdf-element",e=>"function"==typeof e?((e,t)=>(window.customElements.define(e,t),t))(ge,e):((e,t)=>{const{kind:s,elements:i}=t;return{kind:s,elements:i,finisher(t){window.customElements.define(e,t)}}})(ge,e))],ue);export{ue as ViewPDFElement,pe as messageQueue};
