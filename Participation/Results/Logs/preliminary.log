---------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\GitHub\EconAnalysis\Participation\Results\Logs\preliminary.log
  log type:  text
 opened on:  16 Nov 2023, 16:48:04

. 
. ** Import data
. import delimited "C:\Data\PacFIN data\rdo_Stata_c4.csv"
(encoding automatically selected: ISO-8859-1)
(45 vars, 176,730 obs)

. replace mean_price = mean_price / 1000
(147,275 real changes made)

. gen id_obs = _n

. gen const_r2 = 1

. 
. 
. * Model set-up
. global dclosure = "all"

. 
. if "$dclosure" == "1"  {
.         global closure = "if psdntotalclosure == 1"
.         global vars = "exp_revenue wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all msqdweekend"
.         global vars_sdm = "mean_avail mean_price wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all msqdweekend res" 
.         global case = " "
. } 

. else if "$dclosure" == "0" {
.         global closure = "if psdntotalclosure == 0"
.         global vars = "exp_revenue wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all psdnclosured2 psdntotalclosured msqdweekend"
.         global vars_sdm = "mean_avail mean_price wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all psdnclosured2 psdntotalclosured msqdweekend
>  res" 
.         global case = " "
. }

. else if "$dclosure" == "all" {
.         global closure = " "
.         global vars = "exp_revenue wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all psdnclosured2 psdntotalclosured msqdweekend" 
.         global vars_sdm = "mean_avail mean_price wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all psdnclosured2 psdntotalclosured msqdweekend
>  res" 
.         global case = " " // at the end add: lunarill
. }

. 
. 
. ** Add addtional variables
. preserve

.  import delimited "Stata\dbp_month_Stata_c4.csv", clear
(encoding automatically selected: ISO-8859-2)
(3 vars, 23 obs)

.  tempfile dbp_month

.  save dbp_month, replace
file dbp_month.dta saved

. restore

. merge m:1 selection set_month using "dbp_month.dta"

    Result                      Number of obs
    -----------------------------------------
    Not matched                       123,726
        from master                   123,724  (_merge==1)
        from using                          2  (_merge==2)

    Matched                            53,006  (_merge==3)
    -----------------------------------------

. drop if _merge == 2
(2 observations deleted)

. replace hist_selection = 0 if _merge == 1
(123,724 real changes made)

. drop _merge

. gen exp_revenue = mean_price * mean_avail

. gen exp_cost_cog = diesel_price * dist_to_cog 

. gen exp_cost_catch_area = diesel_price * dist_port_to_catch_area_zero

. gen d_missing_all = d_missing_d

. replace d_missing_all = 1 if d_missing == 1
(3 real changes made)

. gen psdnclosured2 = psdnclosured - psdntotalclosured

. gen psdnclosure2 = psdnclosure - psdntotalclosure

. gen species = substr(selection,-4,.) 

. replace species = "No-Participation" if species == "tion" 
variable species was str4 now str16
(29,455 real changes made)

. // encode species, gen(nspecies)
. 
. 
. ** Instrument price
. reg mean_price mean_avail wind_max_220_mh dist_to_cog dist_port_to_catch_area_zero d_missing_all psdnclosured2 psdntotalclosured msqdweekend pricefishmealafi

      Source |       SS           df       MS      Number of obs   =   176,730
-------------+----------------------------------   F(9, 176720)    =   2979.64
       Model |  103917.412         9  11546.3791   Prob > F        =    0.0000
    Residual |  684805.475   176,720  3.87508757   R-squared       =    0.1318
-------------+----------------------------------   Adj R-squared   =    0.1317
       Total |  788722.887   176,729  4.46289453   Root MSE        =    1.9685

----------------------------------------------------------------------------------------------
                  mean_price | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-----------------------------+----------------------------------------------------------------
                  mean_avail |   1.890705   .0301163    62.78   0.000     1.831678    1.949733
             wind_max_220_mh |  -.0089143   .0008776   -10.16   0.000    -.0106344   -.0071943
                 dist_to_cog |   .0013675    .000018    75.79   0.000     .0013322    .0014029
dist_port_to_catch_area_zero |   .0049703   .0001837    27.05   0.000     .0046102    .0053304
               d_missing_all |   .9911619   .0164014    60.43   0.000     .9590156    1.023308
               psdnclosured2 |  -.5456703   .2903364    -1.88   0.060    -1.114723    .0233824
           psdntotalclosured |  -1.416944   .0332247   -42.65   0.000    -1.482063   -1.351824
                 msqdweekend |  -.1313818   .0131503    -9.99   0.000    -.1571561   -.1056076
            pricefishmealafi |  -.0001509   .0000139   -10.88   0.000    -.0001781   -.0001237
                       _cons |   .3305641   .0263721    12.53   0.000     .2788754    .3822529
----------------------------------------------------------------------------------------------

. predict res, residuals

. 
. 
. ******************************
. ** Estimate conditional logits (with alternative-specific constant)
. 
. ** Set choice model database
. // cmset fished_haul selection
. cmset fished_vessel_id time selection
note: case identifier _caseid generated from fished_vessel_id and time.
note: panel by alternatives identifier _panelaltid generated from fished_vessel_id and selection.
note: alternatives are unbalanced across choice sets; at least one choice set does not have all possible values of selection.

                    Panel data: Panels fished_vessel_id and time time
              Case ID variable: _caseid
         Alternatives variable: selection
Panel by alternatives variable: _panelaltid (unbalanced)
                 Time variable: time, 1 to 1701, but with gaps
                         Delta: 1 unit

Note: Data have been xtset.

. sort id_obs

. 
. *** Only-constant model
